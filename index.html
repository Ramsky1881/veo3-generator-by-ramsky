<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veo 3 Prompt Generator</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom Styles for Animations -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        .animate-fade-in-up-toast {
            animation: fadeInUpToast 0.5s ease-out forwards;
        }
        .animate-scale-in {
            animation: scaleIn 0.3s ease-out forwards;
        }
        .animate-breathe {
            animation: breathe 2s infinite ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes fadeInUpToast {
            from {
                opacity: 0;
                transform: translate3d(-50%, 40px, 0);
            }
            to {
                opacity: 1;
                transform: translate3d(-50%, 0, 0);
            }
        }
        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes breathe {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }

        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }
        .delay-400 { animation-delay: 0.4s; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100 p-6 font-sans flex flex-col items-center justify-center">

    <!-- Header Section (Always centered and stretched full width of the container) -->
    <div class="w-full text-center mb-8 max-w-6xl">
        <h1 class="text-5xl font-extrabold text-indigo-800 mb-4 leading-tight tracking-wider">
            Veo 3 Prompt Generator
        </h1>
        <p class="text-gray-600 text-lg">
            Buat prompt video yang detail dan sinematik by ramsky.
        </p>
    </div>

    <div class="bg-white p-10 rounded-3xl shadow-2xl w-full max-w-6xl md:flex md:space-x-10 animate-fade-in">
        <!-- Input Form Section -->
        <div class="md:w-1/2 md:pr-4 mb-8 md:mb-0">
            <!-- Form Fields -->
            <div class="space-y-6">
                <!-- 1. Deskripsi Video Utama -->
                <div class="bg-blue-50 p-4 rounded-lg shadow-sm border border-blue-100">
                    <label for="mainDesc" class="block text-base font-semibold text-blue-800 mb-2">
                        1. Deskripsi Video Utama (Bahasa Indonesia)
                    </label>
                    <textarea
                        id="mainDesc"
                        class="w-full p-3 border border-blue-200 rounded-md shadow-inner bg-white focus:ring-blue-400 focus:border-blue-400 transition duration-200 ease-in-out placeholder-gray-400 text-gray-800"
                        rows="3"
                        placeholder="Contoh: Sebuah kucing oranye yang nakal melompat di atas tumpukan buku tua di perpustakaan yang hangat."
                    ></textarea>
                </div>

                <!-- 2. Detail Subjek (Karakter) - DYNAMIC SECTION -->
                <div class="bg-green-50 p-4 rounded-lg shadow-sm border border-green-100">
                    <label class="block text-base font-semibold text-green-800 mb-2">
                        2. Detail Subjek (Karakter)
                    </label>
                    <div id="characters-container">
                        <!-- Character input fields will be dynamically added here by JavaScript -->
                    </div>
                    <button id="add-character-btn"
                        class="mt-2 w-full bg-green-600 text-white py-2 px-4 rounded-md shadow-md hover:bg-green-700 transition duration-200 ease-in-out flex items-center justify-center text-sm transform hover:-translate-y-0.5"
                    >
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        Tambah Karakter
                    </button>
                </div>


                <!-- 3. Isi Dialog Karakter (DYNAMIC SECTION) -->
                <div class="bg-purple-50 p-4 rounded-lg shadow-sm border border-purple-100">
                    <label class="block text-base font-semibold text-purple-800 mb-2">
                        3. Isi Dialog Karakter (Bahasa Indonesia)
                    </label>
                    <div id="dialogues-container">
                        <!-- Dialogue input fields will be dynamically added here by JavaScript -->
                    </div>
                    <button id="add-dialogue-btn"
                        class="mt-2 w-full bg-purple-600 text-white py-2 px-4 rounded-md shadow-md hover:bg-purple-700 transition duration-200 ease-in-out flex items-center justify-center text-sm transform hover:-translate-y-0.5"
                    >
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
                        Tambah Dialog Karakter
                    </button>
                </div>

                <!-- 4. Latar Belakang -->
                <div class="bg-yellow-50 p-4 rounded-lg shadow-sm border border-yellow-100">
                    <label class="block text-base font-semibold text-yellow-800 mb-2">
                        4. Latar Belakang
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                            <label for="location" class="block text-sm font-medium text-gray-700 mb-1">Lokasi:</label>
                            <select id="location" class="w-full p-2 border border-gray-300 rounded-md focus:ring-yellow-400 focus:border-yellow-400">
                                <option value="">Pilih Lokasi</option>
                                <option value="Perkotaan">Perkotaan</option>
                                <option value="Pedesaan">Pedesaan</option>
                                <option value="Hutan">Hutan</option>
                                <option value="Pantai">Pantai</option>
                                <option value="Pegunungan">Pegunungan</option>
                                <option value="Luar Angkasa">Luar Angkasa</option>
                                <option value="Rumah">Rumah</option>
                                <option value="Kantor">Kantor</option>
                                <option value="Sekolah">Sekolah</option>
                                <option value="Pabrik">Pabrik</option>
                                <option value="Jalan Raya">Jalan Raya</option>
                                <option value="Cafe">Cafe</option>
                                <option value="Restoran">Restoran</option>
                                <option value="Pusat Perbelanjaan">Pusat Perbelanjaan</option>
                                <option value="Reruntuhan">Reruntuhan</option>
                                <option value="Kastil">Kastil</option>
                                <option value="Lab">Lab</option>
                                <option value="Studio">Studio</option>
                                <option value="Kapal">Kapal</option>
                                <option value="Pesawat">Pesawat</option>
                            </select>
                        </div>
                        <div>
                            <label for="time" class="block text-sm font-medium text-gray-700 mb-1">Waktu:</label>
                            <select id="time" class="w-full p-2 border border-gray-300 rounded-md focus:ring-yellow-400 focus:border-yellow-400">
                                <option value="">Pilih Waktu</option>
                                <option value="Pagi Hari">Pagi Hari</option>
                                <option value="Siang Hari">Siang Hari</option>
                                <option value="Sore Hari">Sore Hari</option>
                                <option value="Malam Hari">Malam Hari</option>
                                <option value="Senja (Golden Hour)">Senja (Golden Hour)</option>
                                <option value="Subuh">Subuh</option>
                            </select>
                        </div>
                        <div>
                            <label for="weather" class="block text-sm font-medium text-gray-700 mb-1">Cuaca:</label>
                            <select id="weather" class="w-full p-2 border border-gray-300 rounded-md focus:ring-yellow-400 focus:border-yellow-400">
                                <option value="">Pilih Cuaca</option>
                                <option value="Cerah">Cerah</option>
                                <option value="Berawan">Berawan</option>
                                <option value="Hujan Ringan">Hujan Ringan</option>
                                <option value="Hujan Lebat">Hujan Lebat</option>
                                <option value="Badai">Badai</option>
                                <option value="Salju">Salju</option>
                                <option value="Berkabut">Berkabut</option>
                                <option value="Berangin">Berangin</option>
                            </select>
                        </div>
                        <div>
                            <label for="season" class="block text-sm font-medium text-gray-700 mb-1">Musim:</label>
                            <select id="season" class="w-full p-2 border border-gray-300 rounded-md focus:ring-yellow-400 focus:border-yellow-400">
                                <option value="">Pilih Musim</option>
                                <option value="Musim Semi">Musim Semi</option>
                                <option value="Musim Panas">Musim Panas</option>
                                <option value="Musim Gugur">Musim Gugur</option>
                                <option value="Musim Dingin">Musim Dingin</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 5. Pengaturan Kamera -->
                <div class="bg-red-50 p-4 rounded-lg shadow-sm border border-red-100">
                    <label class="block text-base font-semibold text-red-800 mb-2">
                        5. Pengaturan Kamera
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                        <div>
                            <label for="cameraStyle" class="block text-sm font-medium text-gray-700 mb-1">Gaya:</label>
                            <select id="cameraStyle" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Gaya</option>
                                <option value="Sinematik">Sinematik</option>
                                <option value="Dokumenter">Dokumenter</option>
                                <option value="Vertikal (TikTok/Reels)">Vertikal (TikTok/Reels)</option>
                                <option value="Horizontal (Film/TV)">Horizontal (Film/TV)</option>
                                <option value="Estetik">Estetik</option>
                                <option value="Vintage">Vintage</option>
                                <option value="Modern">Modern</option>
                                <option value="Abstrak">Abstrak</option>
                                <option value="Low-Poly">Low-Poly</option>
                                <option value="Anime">Anime</option>
                                <option value="Cartoon">Cartoon</option>
                                <option value="Realistis">Realistis</option>
                                <option value="Fantasi">Fantasi</option>
                                <option value="Futuristik">Futuristik</option>
                            </select>
                        </div>
                        <div>
                            <label for="cameraMovement" class="block text-sm font-medium text-gray-700 mb-1">Pergerakan Kamera:</label>
                            <select id="cameraMovement" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Pergerakan</option>
                                <option value="Static (Diam)">Static (Diam)</option>
                                <option value="Pan (Horizontal)">Pan (Horizontal)</option>
                                <option value="Tilt (Vertikal)">Tilt (Vertikal)</option>
                                <option value="Dolly (Maju/Mundur)">Dolly (Maju/Mundur)</option>
                                <option value="Track (Samping)">Track (Samping)</option>
                                <option value="Crane (Atas/Bawah)">Crane (Atas/Bawah)</option>
                                <option value="Handheld (Genggam)">Handheld (Genggam)</option>
                                <option value="Zoom In">Zoom In</option>
                                <option value="Zoom Out">Zoom Out</option>
                            </select>
                        </div>
                        <div>
                            <label for="cameraAngle" class="block text-sm font-medium text-gray-700 mb-1">Sudut Kamera:</label>
                            <select id="cameraAngle" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Sudut</option>
                                <option value="Close-up">Close-up</option>
                                <option value="Medium Shot">Medium Shot</option>
                                <option value="Full Shot">Full Shot</option>
                                <option value="Extreme Wide Shot">Extreme Wide Shot</option>
                                <option value="Low Angle">Low Angle</option>
                                <option value="High Angle">High Angle</option>
                                <option value="Dutch Angle (Sudut Miring)">Dutch Angle (Sudut Miring)</option>
                                <option value="Bird's Eye View">Bird's Eye View</option>
                                <option value="Worm's Eye View">Worm's Eye View</option>
                                <option value="Over-the-Shoulder">Over-the-Shoulder</option>
                            </select>
                        </div>
                        <div>
                            <label for="cameraFocus" class="block text-sm font-medium text-gray-700 mb-1">Fokus:</label>
                            <select id="cameraFocus" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Fokus</option>
                                <option value="Shallow Depth of Field (Bokeh)">Shallow Depth of Field (Bokeh)</option>
                                <option value="Deep Depth of Field (Semua Fokus)">Deep Depth of Field (Semua Fokus)</option>
                                <option value="Rack Focus (Perubahan Fokus)">Rack Focus (Perubahan Fokus)</option>
                                <option value="Soft Focus">Soft Focus</option>
                                <option value="Hard Focus">Hard Focus</option>
                            </select>
                        </div>
                        <div>
                            <label for="cameraLighting" class="block text-sm font-medium text-gray-700 mb-1">Pencahayaan:</label>
                            <select id="cameraLighting" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Pencahayaan</option>
                                <option value="Natural (Alami)">Natural (Alami)</option>
                                <option value="Studio Lighting (Profesional)">Studio Lighting (Profesional)</option>
                                <option value="Low Key (Gelap/Misterius)">Low Key (Gelap/Misterius)</option>
                                <option value="High Key (Terang/Ceria)">High Key (Terang/Ceria)</option>
                                <option value="Backlight">Backlight</option>
                                <option value="Frontlight">Frontlight</option>
                                <option value="Side Light">Side Light</option>
                                <option value="Rembramdt Lighting">Rembramdt Lighting</option>
                                <option value="Volumetric Lighting">Volumetric Lighting</option>
                            </select>
                        </div>
                        <div>
                            <label for="colorGrading" class="block text-sm font-medium text-gray-700 mb-1">Gradasi Warna:</label>
                            <select id="colorGrading" class="w-full p-2 border border-gray-300 rounded-md focus:ring-red-400 focus:border-red-400">
                                <option value="">Pilih Gradasi Warna</option>
                                <option value="Hangat (Warm Tone)">Hangat (Warm Tone)</option>
                                <option value="Dingin (Cool Tone)">Dingin (Cool Tone)</option>
                                <option value="Monokrom (Hitam Putih)">Monokrom (Hitam Putih)</option>
                                <option value="Sepia">Sepia</option>
                                <option value="Vibrant (Cerah)">Vibrant (Cerah)</option>
                                <option value="Muted (Pudar)">Muted (Pudar)</option>
                                <option value="Sinematik (Film Look)">Sinematik (Film Look)</option>
                                <option value="HDR">HDR</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- 7. Pengaturan Audio -->
                <div class="bg-indigo-50 p-4 rounded-lg shadow-sm border border-indigo-100">
                    <label class="block text-base font-semibold text-indigo-800 mb-2">
                        7. Pengaturan Audio
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3">
                        <div>
                            <label for="dialogueType" class="block text-sm font-medium text-gray-700 mb-1">Tipe Dialog:</label>
                            <select id="dialogueType" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-400 focus:border-indigo-400">
                                <option value="">Pilih Tipe Dialog</option>
                                <option value="Monolog">Monolog</option>
                                <option value="Dialog antar Karakter">Dialog antar Karakter</option>
                                <option value="Narasi">Narasi</option>
                                <option value="Tanpa Dialog">Tanpa Dialog</option>
                            </select>
                        </div>
                        <div>
                            <label for="soundMood" class="block text-sm font-medium text-gray-700 mb-1">Mood Suara:</label>
                            <select id="soundMood" class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-400 focus:border-indigo-400">
                                <option value="">Pilih Mood</option>
                                <option value="Ceria">Ceria</option>
                                <option value="Mencekam">Mencekam</option>
                                <option value="Misterius">Misterius</option>
                                <option value="Mengharukan">Mengharukan</option>
                                <option value="Enerjik">Enerjik</option>
                                <option value="Santai">Santai</option>
                                <option value="Tegang">Tegang</option>
                            </select>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="environmentSound" class="block text-sm font-medium text-gray-700 mb-1">Suara Lingkungan (Contoh: Deru ombak, kicauan burung):</label>
                        <input
                            type="text"
                            id="environmentSound"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-400 focus:border-indigo-400"
                            placeholder="Contoh: Suara kota ramai, desiran angin"
                        />
                    </div>
                    <div>
                        <label for="backgroundMusic" class="block text-sm font-medium text-gray-700 mb-1">Musik Latar (Contoh: Musik orkestra, musik jazz lembut):</label>
                        <input
                            type="text"
                            id="backgroundMusic"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-indigo-400 focus:border-indigo-400"
                            placeholder="Contoh: Musik latar menenangkan, soundtrack epik"
                        />
                    </div>
                </div>

                <!-- 8. Kualitas Video & Detail Tambahan -->
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200">
                    <label class="block text-base font-semibold text-gray-700 mb-2">
                        8. Kualitas Video & Detail Tambahan
                    </label>
                    <div class="mb-3">
                        <label for="videoQuality" class="block text-sm font-medium text-gray-700 mb-1">Kualitas Video (Contoh: 4K, HD, Sinematik):</label>
                        <input
                            type="text"
                            id="videoQuality"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-gray-400 focus:border-gray-400"
                            placeholder="Contoh: Kualitas sinematik tinggi, resolusi 1080p"
                        />
                    </div>
                    <div>
                        <label for="additionalDetails" class="block text-sm font-medium text-gray-700 mb-1">Detail Tambahan (Catatan penting, instruksi khusus):</label>
                        <textarea
                            id="additionalDetails"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-gray-400 focus:border-gray-400"
                            rows="3"
                            placeholder="Contoh: Fokus pada ekspresi wajah karakter, jangan ada unsur kekerasan."
                        ></textarea>
                    </div>
                </div>
            </div>

            <!-- Generate Button -->
            <!-- Loading indicator above the button -->
            <div id="generate-loading-indicator" class="flex justify-center items-center h-12 mt-10 hidden">
                <svg class="animate-spin h-8 w-8 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <p class="ml-3 text-indigo-700 font-semibold">Membangun Prompt Ajaib...</p>
            </div>
            <button id="generate-prompt-btn"
                class="mt-4 w-full bg-gradient-to-r from-purple-600 to-indigo-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg hover:from-purple-700 hover:to-indigo-800 transition duration-300 ease-in-out transform hover:-translate-y-1 hover:scale-105 flex items-center justify-center text-xl tracking-wide disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none"
            >
                <span id="generate-button-text">Buat Prompt Video!</span>
            </button>
        </div>

        <!-- Output Section -->
        <div class="md:w-1/2 md:pl-4">
            <h2 class="text-4xl font-bold text-indigo-700 mb-6 text-center leading-tight tracking-wider">Hasil Prompt</h2>

            <!-- Indonesian Prompt -->
            <div class="mb-8 bg-blue-50 p-6 rounded-xl shadow-md border border-blue-200 animate-fade-in-up">
                <label for="indonesianPrompt" class="block text-xl font-semibold text-blue-800 mb-3">
                    Prompt Bahasa Indonesia (Bisa Diedit)
                </label>
                <textarea
                    id="indonesianPrompt"
                    class="w-full p-4 border border-blue-300 rounded-lg bg-white shadow-inner focus:ring-blue-500 focus:border-blue-500 transition duration-200 ease-in-out text-gray-800 text-base resize-y"
                    rows="10"
                    placeholder="Prompt Bahasa Indonesia akan muncul di sini setelah dibuat..."
                ></textarea>
                <button id="copy-id-prompt-btn"
                    class="mt-4 w-full bg-blue-600 text-white py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition duration-200 ease-in-out flex items-center justify-center text-lg transform hover:-translate-y-0.5"
                >
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                    Salin Prompt Bahasa Indonesia
                </button>
            </div>

            <!-- English Prompt -->
            <div class="bg-green-50 p-6 rounded-xl shadow-md border border-green-200 animate-fade-in-up delay-100">
                <label for="englishPrompt" class="block text-xl font-semibold text-green-800 mb-3">
                    Prompt Bahasa Inggris (Final)
                </label>
                <textarea
                    id="englishPrompt"
                    class="w-full p-4 border border-green-300 rounded-lg bg-white shadow-inner resize-none text-gray-800 text-base"
                    rows="10"
                    readonly
                    placeholder="Final English prompt will appear here after generation..."
                ></textarea>
                <button id="copy-en-prompt-btn"
                    class="mt-4 w-full bg-green-600 text-white py-3 px-6 rounded-lg shadow-md hover:bg-green-700 transition duration-200 ease-in-out flex items-center justify-center text-lg transform hover:-translate-y-0.5"
                >
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path></svg>
                    Salin Prompt Bahasa Inggris
                </button>
            </div>

            <!-- Prompt Suggestions / Creative Ideas Section -->
            <div class="bg-purple-50 p-6 rounded-xl shadow-md border border-purple-200 mt-8 animate-fade-in-up delay-200">
                <h2 class="text-xl font-semibold text-purple-800 mb-4">Saran Prompt & Ide Kreatif</h2>
                <textarea
                    id="suggestionPrompt"
                    class="w-full p-3 border border-purple-300 rounded-lg bg-white shadow-inner resize-y text-gray-800 text-base"
                    rows="6"
                    placeholder="Saran prompt atau ide kreatif akan muncul di sini setelah dihasilkan..."
                    readonly
                ></textarea>
                <div id="suggestion-loading-indicator" class="flex justify-center items-center h-8 mt-4 hidden">
                    <svg class="animate-spin h-6 w-6 text-purple-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="ml-2 text-purple-700 text-sm">Mencari Ide...</p>
                </div>
                <button id="generate-suggestion-btn"
                    class="mt-4 w-full bg-purple-600 text-white py-2 px-4 rounded-lg shadow-md hover:bg-purple-700 transition duration-200 ease-in-out flex items-center justify-center text-sm transform hover:-translate-y-0.5"
                >
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4.228 4.228l-.707.707M3 12H2m6.364 6.364l-.707-.707M12 21v-1M18.772 4.228l.707.707M12 10.5v.01m0-4.5v.01"></path></svg>
                    Dapatkan Saran Prompt
                </button>
            </div>
        </div>
    </div>

    <!-- Chat Gemini Button -->
    <button id="chat-gemini-btn"
        class="fixed bottom-8 right-8 bg-gradient-to-r from-teal-500 to-green-600 text-white py-4 px-8 rounded-full shadow-xl hover:from-teal-600 hover:to-green-700 transition-all duration-300 ease-in-out transform hover:scale-110 flex items-center group overflow-hidden focus:outline-none focus:ring-4 focus:ring-teal-300 animate-breathe"
    >
        <span class="mr-3 text-3xl">ðŸ’¬</span>
        <span class="font-bold text-xl whitespace-nowrap overflow-hidden pr-2" id="chat-button-text"></span>
    </button>

    <!-- Toast Notification -->
    <div id="toast-notification" class="hidden fixed bottom-8 left-1/2 transform -translate-x-1/2 text-white px-6 py-3 rounded-xl shadow-xl animate-fade-in-up-toast z-50 text-lg flex items-center">
        <svg id="toast-icon" class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path></svg>
        <span id="toast-message"></span>
    </div>

    <!-- Chat Modal -->
    <div id="chat-modal" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl p-8 shadow-2xl max-w-md w-full relative transform scale-95 animate-scale-in">
            <button id="close-chat-modal-btn"
                class="absolute top-4 right-4 text-gray-500 hover:text-gray-800 text-3xl font-bold transition duration-200"
            >
                &times;
            </button>
            <h3 class="text-3xl font-bold text-indigo-700 mb-5">Chat Gemini</h3>
            <p class="text-gray-700 mb-6 text-lg leading-relaxed">
                Fitur obrolan dengan Ramsky (Gemini) akan segera hadir di sini!
                Ini akan memungkinkan Anda mendapatkan bantuan lebih lanjut atau ide-ide kreatif untuk prompt video Anda. Pantau terus!
            </p>
            <button id="confirm-close-chat-modal-btn"
                class="w-full bg-indigo-600 text-white py-3 rounded-lg hover:bg-indigo-700 transition duration-200 font-semibold text-lg"
            >
                Oke, Mengerti!
            </button>
        </div>
    </div>

    <script>
        // DOM Elements
        const mainVideoDescInput = document.getElementById('mainDesc');
        const charactersContainer = document.getElementById('characters-container');
        const addCharacterBtn = document.getElementById('add-character-btn');
        const dialoguesContainer = document.getElementById('dialogues-container');
        const addDialogueBtn = document.getElementById('add-dialogue-btn');

        const locationSelect = document.getElementById('location');
        const timeSelect = document.getElementById('time');
        const weatherSelect = document.getElementById('weather');
        const seasonSelect = document.getElementById('season');

        const cameraStyleSelect = document.getElementById('cameraStyle');
        const cameraMovementSelect = document.getElementById('cameraMovement');
        const cameraAngleSelect = document.getElementById('cameraAngle');
        const cameraFocusSelect = document.getElementById('cameraFocus');
        const cameraLightingSelect = document.getElementById('cameraLighting');
        const colorGradingSelect = document.getElementById('colorGrading');

        const dialogueTypeSelect = document.getElementById('dialogueType');
        const soundMoodSelect = document.getElementById('soundMood');
        const environmentSoundInput = document.getElementById('environmentSound');
        const backgroundMusicInput = document.getElementById('backgroundMusic');

        const videoQualityInput = document.getElementById('videoQuality');
        const additionalDetailsTextarea = document.getElementById('additionalDetails');

        const generatePromptBtn = document.getElementById('generate-prompt-btn');
        const generateButtonText = document.getElementById('generate-button-text');
        const generateSpinner = document.getElementById('generate-spinner');
        const generateLoadingIndicator = document.getElementById('generate-loading-indicator');


        const indonesianPromptTextarea = document.getElementById('indonesianPrompt');
        const englishPromptTextarea = document.getElementById('englishPrompt');
        const copyIdPromptBtn = document.getElementById('copy-id-prompt-btn');
        const copyEnPromptBtn = document.getElementById('copy-en-prompt-btn');

        const suggestionPromptTextarea = document.getElementById('suggestionPrompt');
        const generateSuggestionBtn = document.getElementById('generate-suggestion-btn');
        const suggestionLoadingIndicator = document.getElementById('suggestion-loading-indicator');


        const chatGeminiBtn = document.getElementById('chat-gemini-btn');
        const chatButtonTextSpan = document.getElementById('chat-button-text');
        const chatModal = document.getElementById('chat-modal');
        const closeChatModalBtn = document.getElementById('close-chat-modal-btn');
        const confirmCloseChatModalBtn = document.getElementById('confirm-close-chat-modal-btn');

        const toastNotification = document.getElementById('toast-notification');
        const toastMessageSpan = document.getElementById('toast-message');
        const toastIcon = document.getElementById('toast-icon');

        // Global state variables
        let characterData = [];
        let dialogueData = [];

        // Options (duplicated from React component for direct HTML use)
        const genderOptions = ['', 'Pria', 'Wanita', 'Non-biner', 'Tidak Spesifik'];
        const locationOptions = [
            '', 'Perkotaan', 'Pedesaan', 'Hutan', 'Pantai', 'Pegunungan', 'Luar Angkasa',
            'Rumah', 'Kantor', 'Sekolah', 'Pabrik', 'Jalan Raya', 'Cafe', 'Restoran',
            'Pusat Perbelanjaan', 'Reruntuhan', 'Kastil', 'Lab', 'Studio', 'Kapal', 'Pesawat'
        ];
        const timeOptions = [
            '', 'Pagi Hari', 'Siang Hari', 'Sore Hari', 'Malam Hari', 'Senja (Golden Hour)', 'Subuh'
        ];
        const weatherOptions = [
            '', 'Cerah', 'Berawan', 'Hujan Ringan', 'Hujan Lebat', 'Badai', 'Salju', 'Berkabut', 'Berangin'
        ];
        const seasonOptions = [
            '', 'Musim Semi', 'Musim Panas', 'Musim Gugur', 'Musim Dingin'
        ];
        const cameraStyleOptions = [
            '', 'Sinematik', 'Dokumenter', 'Vertikal (TikTok/Reels)', 'Horizontal (Film/TV)',
            'Estetik', 'Vintage', 'Modern', 'Abstrak', 'Low-Poly', 'Anime', 'Cartoon',
            'Realistis', 'Fantasi', 'Futuristik'
        ];
        const cameraMovementOptions = [
            '', 'Static (Diam)', 'Pan (Horizontal)', 'Tilt (Vertikal)', 'Dolly (Maju/Mundur)',
            'Track (Samping)', 'Crane (Atas/Bawah)', 'Handheld (Genggam)', 'Zoom In', 'Zoom Out'
        ];
        const cameraAngleOptions = [
            '', 'Close-up', 'Medium Shot', 'Full Shot', 'Extreme Wide Shot',
            'Low Angle', 'High Angle', 'Dutch Angle (Sudut Miring)', 'Bird\'s Eye View', 'Worm\'s Eye View', 'Over-the-Shoulder'
        ];
        const cameraFocusOptions = [
            '', 'Shallow Depth of Field (Bokeh)', 'Deep Depth of Field (Semua Fokus)',
            'Rack Focus (Perubahan Fokus)', 'Soft Focus', 'Hard Focus'
        ];
        const cameraLightingOptions = [
            '', 'Natural (Alami)', 'Studio Lighting (Profesional)', 'Low Key (Gelap/Misterius)',
            'High Key (Terang/Ceria)', 'Backlight', 'Frontlight', 'Side Light', 'Rembramdt Lighting', 'Volumetric Lighting'
        ];
        const colorGradingOptions = [
            '', 'Hangat (Warm Tone)', 'Dingin (Cool Tone)', 'Monokrom (Hitam Putih)', 'Sepia',
            'Vibrant (Cerah)', 'Muted (Pudar)', 'Sinematik (Film Look)', 'HDR'
        ];
        const dialogueTypeOptions = [
            '', 'Monolog', 'Dialog antar Karakter', 'Narasi', 'Tanpa Dialog'
        ];
        const soundMoodOptions = [
            '', 'Ceria', 'Mencekam', 'Misterius', 'Mengharukan', 'Enerjik', 'Santai', 'Tegang'
        ];

        // Function to show toast notification
        function showToastNotification(message, type = 'success', duration = 3000) {
            toastMessageSpan.textContent = message;
            toastNotification.classList.remove('hidden');
            toastNotification.classList.remove('bg-green-600', 'bg-red-600'); // Clear previous colors
            toastNotification.classList.add(type === 'success' ? 'bg-green-600' : 'bg-red-600');

            // Set icon based on type
            const iconPath = toastIcon.querySelector('path');
            if (type === 'success') {
                iconPath.setAttribute('d', 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z');
            } else {
                iconPath.setAttribute('d', 'M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z');
            }

            setTimeout(() => {
                toastNotification.classList.add('hidden');
            }, duration);
        }

        // Function to copy text to clipboard
        function copyToClipboard(text, type) {
            if (text) {
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showToastNotification(`${type} prompt berhasil disalin!`, 'success');
            } else {
                showToastNotification(`Tidak ada ${type} prompt untuk disalin.`, 'error');
            }
        }

        // --- Character Management Functions ---
        function createCharacterInput(charData) {
            const charDiv = document.createElement('div');
            charDiv.className = 'bg-green-100 p-4 rounded-lg mb-4 shadow-inner border border-green-200';
            charDiv.setAttribute('data-character-id', charData.id);
            charDiv.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-semibold text-green-800 text-lg character-name-display">${charData.name}</h4>
                    <button class="p-1 text-red-600 hover:text-red-800 transition duration-200 remove-character-btn" title="Hapus Karakter Ini" data-id="${charData.id}">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                    </button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                    <div>
                        <label for="char-name-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Nama Karakter:</label>
                        <input
                            type="text"
                            id="char-name-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Budi, Susi"
                            data-field="name"
                            value="${charData.name}"
                        />
                    </div>
                    <div>
                        <label for="char-gender-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Gender:</label>
                        <select
                            id="char-gender-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            data-field="gender"
                        >
                            ${genderOptions.map(option => `<option value="${option}" ${charData.gender === option ? 'selected' : ''}>${option || 'Pilih Gender'}</option>`).join('')}
                        </select>
                    </div>
                    <div>
                        <label for="char-nationality-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Kewarganegaraan:</label>
                        <input
                            type="text"
                            id="char-nationality-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Indonesia, Amerika"
                            data-field="nationality"
                            value="${charData.nationality}"
                        />
                    </div>
                    <div>
                        <label for="char-age-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Umur:</label>
                        <input
                            type="text"
                            id="char-age-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: 30, Remaja, Anak-anak"
                            data-field="age"
                            value="${charData.age}"
                        />
                    </div>
                    <div>
                        <label for="char-clothing-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Pakaian:</label>
                        <input
                            type="text"
                            id="char-clothing-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Kemeja biru, gaun merah"
                            data-field="clothing"
                            value="${charData.clothing}"
                        />
                    </div>
                    <div>
                        <label for="char-accessories-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Aksesori Tambahan:</label>
                        <input
                            type="text"
                            id="char-accessories-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Topi, kacamata hitam"
                            data-field="accessories"
                            value="${charData.accessories}"
                        />
                    </div>
                    <div>
                        <label for="char-main-action-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Aksi Utama:</label>
                        <input
                            type="text"
                            id="char-main-action-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Berlari, menulis, berbicara"
                            data-field="mainAction"
                            value="${charData.mainAction}"
                        />
                    </div>
                    <div>
                        <label for="char-characteristics-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Karakteristik Subjek:</label>
                        <input
                            type="text"
                            id="char-characteristics-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Tinggi, berambut pirang, atletis"
                            data-field="characteristics"
                            value="${charData.characteristics}"
                        />
                    </div>
                    <div class="col-span-1 md:col-span-2">
                        <label for="char-emotion-${charData.id}" class="block text-sm font-medium text-gray-700 mb-1">Emosi:</label>
                        <input
                            type="text"
                            id="char-emotion-${charData.id}"
                            class="w-full p-2 border border-gray-300 rounded-md focus:ring-green-400 focus:border-green-400"
                            placeholder="Contoh: Bahagia, sedih, marah, netral"
                            data-field="emotion"
                            value="${charData.emotion}"
                        />
                    </div>
                </div>
            `;
            // Add change listeners for the new inputs
            charDiv.querySelectorAll('input, select').forEach(input => {
                input.addEventListener('input', (e) => {
                    const field = e.target.dataset.field;
                    const id = parseInt(charDiv.dataset.characterId);
                    updateCharacterField(id, field, e.target.value);
                    if (field === 'name') {
                        charDiv.querySelector('.character-name-display').textContent = e.target.value || `Karakter ${id}`;
                    }
                });
            });
            // Add listener for remove button if it exists
            const removeBtn = charDiv.querySelector('.remove-character-btn');
            if (removeBtn) {
                removeBtn.addEventListener('click', (e) => {
                    removeCharacter(parseInt(e.currentTarget.dataset.id));
                });
            }
            return charDiv;
        }

        function addCharacter() {
            const newId = characterData.length > 0 ? Math.max(...characterData.map(c => c.id)) + 1 : 1;
            const newChar = {
                id: newId,
                name: `Karakter ${newId}`,
                gender: '',
                nationality: '',
                age: '',
                clothing: '',
                accessories: '',
                mainAction: '',
                characteristics: '',
                emotion: ''
            };
            characterData.push(newChar);
            const newCharElement = createCharacterInput(newChar);
            charactersContainer.appendChild(newCharElement);
            updateRemoveButtonsVisibility(charactersContainer, '.remove-character-btn');
        }

        function removeCharacter(idToRemove) {
            characterData = characterData.filter(char => char.id !== idToRemove);
            const charElementToRemove = charactersContainer.querySelector(`[data-character-id="${idToRemove}"]`);
            if (charElementToRemove) {
                charactersContainer.removeChild(charElementToRemove);
            }
            updateRemoveButtonsVisibility(charactersContainer, '.remove-character-btn');
        }

        function updateCharacterField(id, field, value) {
            const index = characterData.findIndex(char => char.id === id);
            if (index !== -1) {
                characterData[index][field] = value;
            }
        }

        // --- Dialogue Management Functions ---
        function createDialogueInput(dialogueItem) {
            const dialogueDiv = document.createElement('div');
            dialogueDiv.className = 'flex items-center space-x-2 mb-3';
            dialogueDiv.setAttribute('data-dialogue-id', dialogueItem.id);
            dialogueDiv.innerHTML = `
                <input
                    type="text"
                    class="w-1/3 p-2 border border-purple-200 rounded-md shadow-inner bg-white focus:ring-purple-400 focus:border-purple-400 transition duration-200 ease-in-out placeholder-gray-400 text-gray-800"
                    placeholder="Karakter ${dialogueItem.id}"
                    data-field="characterName"
                    value="${dialogueItem.characterName}"
                />
                <textarea
                    class="w-2/3 p-2 border border-purple-200 rounded-md shadow-inner bg-white focus:ring-purple-400 focus:border-purple-400 transition duration-200 ease-in-out placeholder-gray-400 text-gray-800"
                    rows="1"
                    placeholder="Dialog karakter..."
                    data-field="dialogueText"
                >${dialogueItem.dialogueText}</textarea>
                <button class="p-1 text-red-600 hover:text-red-800 transition duration-200 remove-dialogue-btn" title="Hapus Dialog Ini" data-id="${dialogueItem.id}">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                </button>
            `;
            dialogueDiv.querySelectorAll('input, textarea').forEach(input => {
                input.addEventListener('input', (e) => {
                    const field = e.target.dataset.field;
                    const id = parseInt(dialogueDiv.dataset.dialogueId);
                    updateDialogueField(id, field, e.target.value);
                });
            });
            const removeBtn = dialogueDiv.querySelector('.remove-dialogue-btn');
            removeBtn.addEventListener('click', (e) => {
                removeCharacterDialogue(parseInt(e.currentTarget.dataset.id));
            });
            return dialogueDiv;
        }

        function addCharacterDialogue() {
            const newId = dialogueData.length > 0 ? Math.max(...dialogueData.map(d => d.id)) + 1 : 1;
            const newDialogue = { id: newId, characterName: `Karakter ${newId}`, dialogueText: '' };
            dialogueData.push(newDialogue);
            const newDialogueElement = createDialogueInput(newDialogue);
            dialoguesContainer.appendChild(newDialogueElement);
            updateRemoveButtonsVisibility(dialoguesContainer, '.remove-dialogue-btn');
        }

        function removeCharacterDialogue(idToRemove) {
            dialogueData = dialogueData.filter(dialogue => dialogue.id !== idToRemove);
            const dialogueElementToRemove = dialoguesContainer.querySelector(`[data-dialogue-id="${idToRemove}"]`);
            if (dialogueElementToRemove) {
                dialoguesContainer.removeChild(dialogueElementToRemove);
            }
            updateRemoveButtonsVisibility(dialoguesContainer, '.remove-dialogue-btn');
        }

        function updateDialogueField(id, field, value) {
            const index = dialogueData.findIndex(d => d.id === id);
            if (index !== -1) {
                dialogueData[index][field] = value;
            }
        }

        // Helper to control visibility of remove buttons
        function updateRemoveButtonsVisibility(container, buttonSelector) {
            const items = container.children;
            Array.from(items).forEach(item => {
                const removeBtn = item.querySelector(buttonSelector);
                if (removeBtn) {
                    if (items.length <= 1) {
                        removeBtn.classList.add('hidden');
                    } else {
                        removeBtn.classList.remove('hidden');
                    }
                }
            });
        }


        // Function to generate the prompt
        async function generatePrompt() {
            // Show loading state
            generatePromptBtn.disabled = true;
            generateButtonText.classList.add('hidden');
            generateLoadingIndicator.classList.remove('hidden');
            indonesianPromptTextarea.value = '';
            englishPromptTextarea.value = '';
            suggestionPromptTextarea.value = ''; // Clear suggestions too

            // Read all current values from the DOM for static inputs
            const mainVideoDesc = mainVideoDescInput.value;
            const location = locationSelect.value;
            const time = timeSelect.value;
            const weather = weatherSelect.value;
            const season = seasonSelect.value;
            const cameraStyle = cameraStyleSelect.value;
            const cameraMovement = cameraMovementSelect.value;
            const cameraAngle = cameraAngleSelect.value;
            const cameraFocus = cameraFocusSelect.value;
            const cameraLighting = cameraLightingSelect.value;
            const colorGrading = colorGradingSelect.value;
            const dialogueType = dialogueTypeSelect.value;
            const soundMood = soundMoodSelect.value;
            const environmentSound = environmentSoundInput.value;
            const backgroundMusic = backgroundMusicInput.value;
            const videoQuality = videoQualityInput.value;
            const additionalDetails = additionalDetailsTextarea.value;


            // Format subject characters for the prompt
            const formattedCharacters = characterData
                .map(char => {
                    let details = [`Nama: ${char.name || 'Tidak disebutkan'}`];
                    if (char.gender) details.push(`Gender: ${char.gender}`);
                    if (char.nationality) details.push(`Kewarganegaraan: ${char.nationality}`);
                    if (char.age) details.push(`Umur: ${char.age}`);
                    if (char.clothing) details.push(`Pakaian: ${char.clothing}`);
                    if (char.accessories) details.push(`Aksesori Tambahan: ${char.accessories}`);
                    if (char.mainAction) details.push(`Aksi Utama: ${char.mainAction}`);
                    if (char.characteristics) details.push(`Karakteristik: ${char.characteristics}`);
                    if (char.emotion) details.push(`Emosi: ${char.emotion}`);
                    return `- ${details.join(', ')}`;
                })
                .join('\n');

            const characterSection = formattedCharacters ? `Detail Subjek (Karakter):\n${formattedCharacters}` : 'Detail Subjek (Karakter): Tidak ada.';

            // Format dialogues for the prompt
            const formattedDialogues = dialogueData
                .filter(d => d.dialogueText.trim() !== '') // Only include dialogues that have text
                .map(d => `${d.characterName}: "${d.dialogueText}"`)
                .join('\n');

            const dialogueSection = formattedDialogues ? `Isi Dialog Karakter:\n${formattedDialogues}` : 'Isi Dialog Karakter: Tidak ada dialog.';

            // Format Background details
            const backgroundDetails = [];
            if (location) backgroundDetails.push(`Lokasi: ${location}`);
            if (time) backgroundDetails.push(`Waktu: ${time}`);
            if (weather) backgroundDetails.push(`Cuaca: ${weather}`);
            if (season) backgroundDetails.push(`Musim: ${season}`);
            const backgroundSection = backgroundDetails.length > 0 ? `Latar Belakang:\n${backgroundDetails.map(d => `- ${d}`).join('\n')}` : 'Latar Belakang: Tidak ada.';

            // Format Camera Settings details
            const cameraSettingsDetails = [];
            if (cameraStyle) cameraSettingsDetails.push(`Gaya: ${cameraStyle}`);
            if (cameraMovement) cameraSettingsDetails.push(`Pergerakan Kamera: ${cameraMovement}`);
            if (cameraAngle) cameraSettingsDetails.push(`Sudut Kamera: ${cameraAngle}`);
            if (cameraFocus) cameraSettingsDetails.push(`Fokus: ${cameraFocus}`);
            if (cameraLighting) cameraSettingsDetails.push(`Pencahayaan: ${cameraLighting}`);
            if (colorGrading) cameraSettingsDetails.push(`Gradasi Warna: ${colorGrading}`);
            const cameraSettingsSection = cameraSettingsDetails.length > 0 ? `Pengaturan Kamera:\n${cameraSettingsDetails.map(d => `- ${d}`).join('\n')}` : 'Pengaturan Kamera: Default.';

            // Format Audio Settings details
            const audioSettingsDetails = [];
            if (dialogueType) audioSettingsDetails.push(`Tipe Dialog: ${dialogueType}`);
            if (soundMood) audioSettingsDetails.push(`Mood Suara: ${soundMood}`);
            if (environmentSound) audioSettingsDetails.push(`Suara Lingkungan: ${environmentSound}`);
            if (backgroundMusic) audioSettingsDetails.push(`Musik Latar: ${backgroundMusic}`);
            const audioSettingsSection = audioSettingsDetails.length > 0 ? `Pengaturan Audio:\n${audioSettingsDetails.map(d => `- ${d}`).join('\n')}` : 'Pengaturan Audio: Tidak ada.';

            // Format Video Quality & Additional Details
            const qualityDetailsSection = [];
            if (videoQuality) qualityDetailsSection.push(`Kualitas Video: ${videoQuality}`);
            if (additionalDetails) qualityDetailsSection.push(`Detail Tambahan: ${additionalDetails}`);
            const finalQualitySection = qualityDetailsSection.length > 0 ? `Kualitas Video & Detail Tambahan:\n${qualityDetailsSection.map(d => `- ${d}`).join('\n')}` : 'Kualitas Video & Detail Tambahan: Default.';


            // Construct the base Indonesian prompt
            const baseIndonesianPrompt = `
                Video Utama: ${mainVideoDesc || 'Sebuah adegan video yang menarik.'}
                ${characterSection}
                ${dialogueSection}
                ${backgroundSection}
                ${cameraSettingsSection}
                ${audioSettingsSection}
                ${finalQualitySection}
            `.trim().replace(/(\n\s*){3,}/g, '\n\n'); // Tidy up blank lines

            indonesianPromptTextarea.value = baseIndonesianPrompt;

            try {
                // Call Gemini API to enhance and translate the prompt
                let chatHistory = [];
                chatHistory.push({
                    role: "user",
                    parts: [{
                        text: `Terjemahkan dan kembangkan prompt video berikut ke dalam Bahasa Inggris yang sangat detail dan sinematik untuk Veo 3 AI:
                        "${baseIndonesianPrompt}"

                        Sertakan detail seperti gaya visual, pencahayaan, tekstur, suasana hati, dan komposisi kamera. Prompt harus siap untuk digunakan langsung oleh AI generasi video.

                        Contoh pengembangan:
                        "A breathtaking panoramic view of a lush, ancient forest at dawn. Golden light filters through the dense canopy, highlighting dew-kissed spiderwebs and a faint mist rising from the forest floor. The atmosphere is serene and mystical. Focus on vibrant greens and deep earthy tones. The air feels cool and fresh. A gentle breeze rustles the leaves."

                        Pastikan outputnya hanya prompt bahasa Inggris saja, tanpa tambahan kalimat pembuka atau penutup. The response should be a complete sentence or paragraph.`
                    }]
                });

                const payload = { contents: chatHistory };
                // WARNING: Hardcoding API keys is not recommended for production applications.
                // This key is added back based on user request.
                const apiKey = "AIzaSyCeC4RzS5_GETZO0Ql8tJehZtV-rREnrpI"; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API error: ${response.status} - ${errorData.error.message || 'Unknown error'}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const generatedEnglishPrompt = result.candidates[0].content.parts[0].text;
                    englishPromptTextarea.value = generatedEnglishPrompt;
                    showToastNotification('Prompt berhasil dibuat!', 'success');
                } else {
                    console.error("Unexpected API response structure:", result);
                    showToastNotification('Gagal menghasilkan prompt bahasa Inggris. Struktur respons tidak terduga.', 'error');
                }
            } catch (error) {
                console.error("Error generating prompt:", error);
                showToastNotification(`Gagal menghasilkan prompt: ${error.message}`, 'error');
            } finally {
                // Hide loading state
                generatePromptBtn.disabled = false;
                generateButtonText.classList.remove('hidden');
                generateLoadingIndicator.classList.add('hidden'); // Ensure it hides
            }
        }

        // Function to generate prompt suggestions
        async function generatePromptSuggestions() {
            suggestionPromptTextarea.value = ''; // Clear previous suggestions
            generateSuggestionBtn.disabled = true;
            suggestionLoadingIndicator.classList.remove('hidden');

            const currentEnglishPrompt = englishPromptTextarea.value;
            if (!currentEnglishPrompt) {
                showToastNotification('Harap buat prompt utama terlebih dahulu untuk mendapatkan saran.', 'error');
                generateSuggestionBtn.disabled = false;
                suggestionLoadingIndicator.classList.add('hidden');
                return;
            }

            try {
                let chatHistory = [];
                chatHistory.push({
                    role: "user",
                    parts: [{
                        text: `Berdasarkan prompt video Veo 3 berikut, berikan 3-5 ide atau saran kreatif untuk mengembangkan prompt ini lebih lanjut. Fokus pada aspek visual, suasana, atau alur cerita yang bisa diperkaya. Format sebagai daftar poin yang jelas.

                        Prompt asli: "${currentEnglishPrompt}"

                        Contoh saran:
                        - Tambahkan efek visual kabut tipis di pagi hari.
                        - Pertimbangkan transisi kamera yang lembut dari close-up ke wide shot.
                        - Kembangkan karakter pendukung yang memberikan reaksi emosional.
                        - Beri sentuhan warna cerah pada objek tertentu untuk penekanan.
                        - Ciptakan momen kejutan kecil di akhir adegan.`
                    }]
                });

                const payload = { contents: chatHistory };
                // WARNING: Hardcoding API keys is not recommended for production applications.
                // This key is added back based on user request.
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API error: ${response.status} - ${errorData.error.message || 'Unknown error'}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const generatedSuggestions = result.candidates[0].content.parts[0].text;
                    suggestionPromptTextarea.value = generatedSuggestions;
                    showToastNotification('Saran prompt berhasil dibuat!', 'success');
                } else {
                    console.error("Unexpected API response structure for suggestions:", result);
                    showToastNotification('Gagal menghasilkan saran prompt. Struktur respons tidak terduga.', 'error');
                }
            } catch (error) {
                console.error("Error generating suggestions:", error);
                showToastNotification(`Gagal menghasilkan saran: ${error.message}`, 'error');
            } finally {
                generateSuggestionBtn.disabled = false;
                suggestionLoadingIndicator.classList.add('hidden');
            }
        }


        // --- Chat Button Animation ---
        const fullChatButtonText = "bingung? chat ramsky disini";
        let chatTextCurrentIndex = 0;
        let chatTextTimeout;

        function animateChatText() {
            if (chatTextCurrentIndex <= fullChatButtonText.length) {
                chatButtonTextSpan.textContent = fullChatButtonText.substring(0, chatTextCurrentIndex);
                chatTextCurrentIndex++;
                chatTextTimeout = setTimeout(animateChatText, 100); // Typing speed
            } else {
                // Once fully typed, wait and then reset to start typing again
                chatTextTimeout = setTimeout(() => {
                    chatTextCurrentIndex = 0;
                    animateChatText();
                }, 2000); // Pause before re-typing
            }
        }

        // --- Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            // Clear containers and initialize
            charactersContainer.innerHTML = '';
            dialoguesContainer.innerHTML = '';
            addCharacter();
            addCharacterDialogue();

            // Attach event listeners
            addCharacterBtn.addEventListener('click', addCharacter);
            addDialogueBtn.addEventListener('click', addCharacterDialogue);
            generatePromptBtn.addEventListener('click', generatePrompt);
            generateSuggestionBtn.addEventListener('click', generatePromptSuggestions); // New listener for suggestions
            copyIdPromptBtn.addEventListener('click', () => copyToClipboard(indonesianPromptTextarea.value, 'Bahasa Indonesia'));
            copyEnPromptBtn.addEventListener('click', () => copyToClipboard(englishPromptTextarea.value, 'Bahasa Inggris'));
            chatGeminiBtn.addEventListener('click', () => chatModal.classList.remove('hidden'));
            closeChatModalBtn.addEventListener('click', () => chatModal.classList.add('hidden'));
            confirmCloseChatModalBtn.addEventListener('click', () => chatModal.classList.add('hidden'));

            // Start chat button animation
            animateChatText();
        });

    </script>
</body>
</html>
